<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Monitoring Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/dashboard.css') }}" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
</head>
<body>
    <div class="container-fluid">
        <!-- Header -->
        <div class="row header">
            <div class="col-12">
                <h1><i class="fas fa-heartbeat"></i> Health Monitoring Dashboard</h1>
                <div class="connection-status">
                    <span id="status-indicator" class="status-dot"></span>
                    <span id="status-text">Disconnected</span>
                    <button id="connect-btn" class="btn btn-success btn-sm">
                        <i class="fas fa-plug"></i> Connect Device
                    </button>
                    <button id="disconnect-btn" class="btn btn-danger btn-sm" style="display: none;">
                        <i class="fas fa-unplug"></i> Disconnect
                    </button>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="row mb-4">
            <div class="col-12">
                <ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="monitoring-tab" data-bs-toggle="tab" data-bs-target="#monitoring" type="button" role="tab">
                            <i class="fas fa-chart-line"></i> Health Monitoring
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="assessment-tab" data-bs-toggle="tab" data-bs-target="#assessment" type="button" role="tab">
                            <i class="fas fa-thermometer-full"></i> Heat Stroke Assessment
                        </button>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Tab Content -->
        <div class="tab-content" id="dashboardTabContent">
            <!-- Health Monitoring Tab -->
            <div class="tab-pane fade show active" id="monitoring" role="tabpanel">
                <!-- User Profile Section -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-user"></i> User Profile</h5>
                            </div>
                            <div class="card-body">
                                <form id="user-profile-form">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label for="user-age" class="form-label">Age</label>
                                                <input type="number" class="form-control" id="user-age" name="age" min="1" max="120" placeholder="Enter your age">
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label for="user-gender" class="form-label">Gender</label>
                                                <select class="form-select" id="user-gender" name="gender">
                                                    <option value="">Select gender</option>
                                                    <option value="male">Male</option>
                                                    <option value="female">Female</option>
                                                    <option value="other">Other</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label class="form-label">&nbsp;</label>
                                                <button type="submit" class="btn btn-primary w-100">
                                                    <i class="fas fa-save"></i> Save Profile
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                                <div id="profile-info" class="mt-3" style="display: none;">
                                    <div class="alert alert-info">
                                        <strong>Profile:</strong> <span id="profile-display"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Real-time Data Cards -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="card data-card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h5 class="card-title">Heart Rate</h5>
                                        <h2 id="heart-rate-value">-- BPM</h2>
                                    </div>
                                    <div class="icon-container">
                                        <i class="fas fa-heartbeat"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card data-card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h5 class="card-title">Temperature</h5>
                                        <h2 id="temp-value">--Â°C</h2>
                                    </div>
                                    <div class="icon-container">
                                        <i class="fas fa-thermometer-half"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card data-card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h5 class="card-title">Humidity</h5>
                                        <h2 id="humidity-value">--%</h2>
                                    </div>
                                    <div class="icon-container">
                                        <i class="fas fa-tint"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card data-card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h5 class="card-title">Activity Level</h5>
                                        <h2 id="activity-value">--</h2>
                                    </div>
                                    <div class="icon-container">
                                        <i class="fas fa-running"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-chart-line"></i> Heart Rate & Temperature</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="heartRateTempChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-chart-bar"></i> Activity & Humidity</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="activityHumidityChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Health Insights -->
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-lightbulb"></i> Health Insights</h5>
                            </div>
                            <div class="card-body">
                                <div id="health-insights" class="health-insights">
                                    <div class="alert alert-warning">
                                        <i class="fas fa-info-circle"></i> Please save your profile and connect your device to see personalized health insights.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Data Log -->
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-list"></i> Recent Data Log</h5>
                                <button id="clear-log" class="btn btn-sm btn-outline-secondary">Clear Log</button>
                            </div>
                            <div class="card-body">
                                <div id="data-log" class="data-log"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Heat Stroke Assessment Tab -->
            <div class="tab-pane fade" id="assessment" role="tabpanel">
                <!-- Assessment Form -->
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-clipboard-list"></i> Heat Stroke Assessment Form</h5>
                            </div>
                            <div class="card-body">
                                <form id="heat-stroke-assessment-form">
                                    <!-- Core Temperature Assessment -->
                                    <div class="assessment-section">
                                        <h6 class="section-title"><i class="fas fa-thermometer-half"></i> Core Temperature Assessment</h6>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="core-temp" class="form-label">Core Body Temperature (Â°F)</label>
                                                    <input type="number" class="form-control" id="core-temp" name="core_temp" 
                                                           step="0.1" min="90" max="110" placeholder="e.g., 98.6">
                                                    <small class="form-text text-muted">Rectal temperature is most accurate for heat stroke assessment</small>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="temp-method" class="form-label">Temperature Measurement Method</label>
                                                    <select class="form-select" id="temp-method" name="temp_method">
                                                        <option value="rectal">Rectal (Most Accurate)</option>
                                                        <option value="oral">Oral</option>
                                                        <option value="ear">Ear</option>
                                                        <option value="forehead">Forehead</option>
                                                        <option value="temporal">Temporal</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Mental Status Evaluation -->
                                    <div class="assessment-section">
                                        <h6 class="section-title"><i class="fas fa-brain"></i> Mental Status Evaluation</h6>
                                        <div class="form-group">
                                            <label for="mental-status" class="form-label">Mental Status</label>
                                            <select class="form-select" id="mental-status" name="mental_status" required>
                                                <option value="">Select mental status</option>
                                                <option value="normal">Normal</option>
                                                <option value="confused">Confused</option>
                                                <option value="disoriented">Disoriented</option>
                                                <option value="agitated">Agitated</option>
                                                <option value="delirious">Delirious</option>
                                                <option value="hallucinating">Hallucinating</option>
                                                <option value="unconscious">Unconscious</option>
                                                <option value="seizure">Seizure</option>
                                                <option value="slurred_speech">Slurred Speech</option>
                                                <option value="drowsy">Drowsy</option>
                                                <option value="lethargic">Lethargic</option>
                                                <option value="irritable">Irritable</option>
                                            </select>
                                            <small class="form-text text-muted">Central nervous system dysfunction is hallmark of heat stroke</small>
                                        </div>
                                    </div>

                                    <!-- Vital Signs -->
                                    <div class="assessment-section">
                                        <h6 class="section-title"><i class="fas fa-heartbeat"></i> Vital Signs</h6>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label for="heart-rate" class="form-label">Heart Rate (BPM)</label>
                                                    <input type="number" class="form-control" id="heart-rate" name="heart_rate" 
                                                           min="40" max="200" placeholder="e.g., 80">
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label for="respiratory-rate" class="form-label">Respiratory Rate (per min)</label>
                                                    <input type="number" class="form-control" id="respiratory-rate" name="respiratory_rate" 
                                                           min="8" max="50" placeholder="e.g., 16">
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label for="blood-pressure" class="form-label">Blood Pressure</label>
                                                    <input type="text" class="form-control" id="blood-pressure" name="blood_pressure" 
                                                           placeholder="e.g., 120/80">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Environmental Factors -->
                                    <div class="assessment-section">
                                        <h6 class="section-title"><i class="fas fa-sun"></i> Environmental Factors</h6>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label for="env-temp" class="form-label">Environmental Temperature (Â°F)</label>
                                                    <input type="number" class="form-control" id="env-temp" name="env_temp" 
                                                           min="50" max="120" placeholder="e.g., 85">
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label for="humidity" class="form-label">Humidity (%)</label>
                                                    <input type="number" class="form-control" id="humidity" name="humidity" 
                                                           min="0" max="100" placeholder="e.g., 60">
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label for="activity-level" class="form-label">Activity Level</label>
                                                    <select class="form-select" id="activity-level" name="activity_level">
                                                        <option value="resting">Resting</option>
                                                        <option value="light">Light Activity</option>
                                                        <option value="moderate">Moderate Exercise</option>
                                                        <option value="strenuous">Strenuous Exercise</option>
                                                        <option value="extreme">Extreme Exercise</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Symptoms Assessment -->
                                    <div class="assessment-section">
                                        <h6 class="section-title"><i class="fas fa-exclamation-triangle"></i> Symptoms Assessment</h6>
                                        <div class="form-group">
                                            <label class="form-label">Select all applicable symptoms:</label>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="headache" name="symptoms" value="headache">
                                                        <label class="form-check-label" for="headache">Headache</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="dizziness" name="symptoms" value="dizziness">
                                                        <label class="form-check-label" for="dizziness">Dizziness</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="nausea" name="symptoms" value="nausea">
                                                        <label class="form-check-label" for="nausea">Nausea</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="vomiting" name="symptoms" value="vomiting">
                                                        <label class="form-check-label" for="vomiting">Vomiting</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="muscle_cramps" name="symptoms" value="muscle_cramps">
                                                        <label class="form-check-label" for="muscle_cramps">Muscle Cramps</label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="weakness" name="symptoms" value="weakness">
                                                        <label class="form-check-label" for="weakness">Weakness</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="fatigue" name="symptoms" value="fatigue">
                                                        <label class="form-check-label" for="fatigue">Fatigue</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="hot_skin" name="symptoms" value="hot_skin">
                                                        <label class="form-check-label" for="hot_skin">Hot Skin</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="dry_skin" name="symptoms" value="dry_skin">
                                                        <label class="form-check-label" for="dry_skin">Dry Skin</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="rapid_breathing" name="symptoms" value="rapid_breathing">
                                                        <label class="form-check-label" for="rapid_breathing">Rapid Breathing</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Medical History -->
                                    <div class="assessment-section">
                                        <h6 class="section-title"><i class="fas fa-notes-medical"></i> Medical History & Risk Factors</h6>
                                        <div class="form-group">
                                            <label class="form-label">Select all applicable risk factors:</label>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="cardiovascular" name="risk_factors" value="cardiovascular">
                                                        <label class="form-check-label" for="cardiovascular">Cardiovascular Disease</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="diabetes" name="risk_factors" value="diabetes">
                                                        <label class="form-check-label" for="diabetes">Diabetes</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="obesity" name="risk_factors" value="obesity">
                                                        <label class="form-check-label" for="obesity">Obesity</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="elderly" name="risk_factors" value="elderly">
                                                        <label class="form-check-label" for="elderly">Elderly (>65 years)</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="medications" name="risk_factors" value="medications">
                                                        <label class="form-check-label" for="medications">Heat-Sensitive Medications</label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="dehydration" name="risk_factors" value="dehydration">
                                                        <label class="form-check-label" for="dehydration">Dehydration</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="alcohol" name="risk_factors" value="alcohol">
                                                        <label class="form-check-label" for="alcohol">Alcohol Use</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="previous_heat" name="risk_factors" value="previous_heat">
                                                        <label class="form-check-label" for="previous_heat">Previous Heat Illness</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="poor_acclimation" name="risk_factors" value="poor_acclimation">
                                                        <label class="form-check-label" for="poor_acclimation">Poor Heat Acclimation</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="exertion" name="risk_factors" value="exertion">
                                                        <label class="form-check-label" for="exertion">Prolonged Exertion</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Submit Button -->
                                    <div class="assessment-section">
                                        <button type="submit" class="btn btn-primary btn-lg">
                                            <i class="fas fa-stethoscope"></i> Assess Heat Stroke Risk
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Assessment Results Panel -->
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-clipboard-check"></i> Assessment Results</h5>
                            </div>
                            <div class="card-body">
                                <div id="assessment-results">
                                    <div class="alert alert-info">
                                        <i class="fas fa-info-circle"></i> Complete the assessment form to see results.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Assessment History -->
                        <div class="card mt-3">
                            <div class="card-header">
                                <h5><i class="fas fa-history"></i> Assessment History</h5>
                            </div>
                            <div class="card-body">
                                <div id="assessment-history">
                                    <p class="text-muted">No previous assessments found.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom Scripts -->
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
    <script src="{{ url_for('static', filename='js/heat_stroke_assessment.js') }}"></script>
</body>
</html> 